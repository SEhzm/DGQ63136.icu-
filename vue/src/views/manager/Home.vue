<template>
  <div>
    <img src="https://pic.imgdb.cn/item/6607ee969f345e8d03ae656d.png" alt="DGä¸¾ç‰Œ" class="DGjvpai">
    <div class="card" style="line-height: 30px">
      <div>
        <b style="margin-left:25px;font-size:27px;color:red;">ğŸ‚ğŸ‚ğŸ‚ğŸ‚ç”Ÿæ—¥å¿«ä¹å†¬ç“œå¼ºğŸ‚ğŸ‚ğŸ‚ğŸ‚
<!--          <br>è·ç¦»ä¸¢ä¸¢é«˜è€ƒè¿˜æœ‰{{ diudiugaokao }}å¤©-->
          <br>è·ç¦»9æœˆ17æ—¥00:04:17æ‰¹é«˜æˆ·å¤–çœ‹å¥³ä¸»æ’­æµå“ˆå–‡å­ï¼Œå¹¶è¡¨ç¤ºç‹¬å 63136è¿˜æœ‰{{ DaoJiShi }}å¤©ï¼Œè­¦é’Ÿé•¿é¸£ï¼
          <img src="https://pic.imgdb.cn/item/6607ee8f9f345e8d03ae39d8.png" alt="æç‹—å¤´" class="dog_head"></b>
      </div>

    </div>
    <div class="card" style="line-height: 30px;margin-top: 10px;">
      <div><b><em style="font-size: 17px;color: red;">æ–°å¢æ—¶å…‰ç›¸å†Œ2015å¹´-2024å¹´(å¯è¯„è®º)ï¼Œæ–°å¢åœ¨çº¿æŠ•ç¨¿å¼¹å¹•(å¯ç›´æ¥æŸ¥çœ‹ï¼Œä¸ç”¨å®¡æ ¸ç‰ˆ)</em></b></div>
    </div>

    <div class="card" style="line-height: 30px; margin-top:8px ;">
      <p>ä½ å¥½ï¼Œå„ä½ç™½å­—ã€‚ <br>
        è¿™æ˜¯ä¸€ä¸ªæ”¶é›†å•æ‰€å¼¹å¹•çš„ç½‘ç«™: <span style="font-size: 24px; font-weight: bold; ">
          <a href="https://dgq63136.icu" style="color: red;">DGQ63136.icu
            <img src="https://pic.imgdb.cn/item/6607ee8f9f345e8d03ae393c.png" alt="é¸¡æ¯™ä½ " class="biabiabia"></a></span>
        <br>
      </p>
    </div>

    <div class="card" style="line-height: 50px; margin-top: 8px;">
      <div>
        <el-button type="primary" @click="getRandomItem">ç‚¹æˆ‘éšæœºä¸€æ¡å¼¹å¹•</el-button>
        <el-table v-if="randomlySelectedItem" :data="[randomlySelectedItem]"
                  style="font-family: å¾®è½¯é›…é»‘; font-size: 20px;">
          <el-table-column prop="barrage" label="å¼¹å¹•"></el-table-column>
          <el-table-column label="" align="center" width="85">
            <template #default="scope">
              <el-button type="primary" @click="copyText(scope.row)">å¤åˆ¶</el-button>
            </template>
          </el-table-column>
        </el-table>
        <div v-else>
          <p>æœªé€‰æ‹©éšæœºé¡¹</p>
        </div>
      </div>
    </div>

    <div class="card" style="line-height: 50px; margin-top: 10px; margin-bottom: 10px; min-height: 120px;">
      <div>
      <span style="position: absolute; font-size: 30px; margin-top: -20px; color: blue;">
        --------æœç´¢åœ¨è¿™ï¼ŒğŸ¦å—---------
      </span>
        <el-input v-model="searchQuery" placeholder="æœç´¢å¼¹å¹•..." style="font-size: 30px; margin-top: 30px;">
        </el-input>
        <el-table v-if="searchQuery" :data="filteredItems" stripe>
          <el-table-column prop="barrage" label="å¼¹å¹•"></el-table-column>
          <el-table-column label="" align="center" width="85">
            <template #default="scope">
              <el-button type="primary" @click="copyText(scope.row)">å¤åˆ¶</el-button>
            </template>
          </el-table-column>
        </el-table>
      </div>
    </div>

    <div class="card" style="margin-top: 8px; text-align: center;">

      <div style="width: 700px;">
        <el-form :model="data" label-width="100px" :rules="rules" label-position="right">
          <el-form-item label="åˆ†æ " :label-width="100" prop="table">
            <el-select v-model="data.table" placeholder="é€‰æ‹©ä¸Šä¼ çš„åˆ†æ ">
              <el-option label="2022å¹´è­¦é’Ÿé•¿é¸£" value="J2022"/>
              <el-option label="2023å¹´è­¦é’Ÿé•¿é¸£" value="J2023"/>
              <el-option label="2024å¹´è­¦é’Ÿé•¿é¸£" value="J2024"/>
              <el-option label="+1" value="p1"/>
              <el-option label="ğŸ˜è¶…å“¥ğŸ˜" value="ruibin"/>
              <el-option label="å°å›¢ä½“" value="XTT"/>
              <el-option label="DGQ" value="DGQ"/>
              <el-option label="ç™½å­—" value="baizi"/>
              <el-option label="QUQU" value="QUQU"/>
            </el-select>
          </el-form-item>
          <el-form-item label="å¼¹å¹•å†…å®¹" prop="barrage">
            <el-input v-model="data.barrage" autocomplete="off"/>
          </el-form-item>
          <el-button type="primary" @click="saveBarrage" style="font-size: 20px;">
            æŠ•ç¨¿
          </el-button>
        </el-form>
      </div>

      <img src="https://pic.imgdb.cn/item/6607ee909f345e8d03ae3cc1.png" alt="ğŸ‘ğŸ‘ğŸ‘" class="good">&nbsp;
      </div>
    <div style="text-align: center;font-size: 17px;margin-left: -250px;">
      <a href="https://beian.miit.gov.cn/" target="_blank">æœ¬ç½‘ç«™åŸºäºè…¾è®¯äº‘æœåŠ¡å™¨æ­å»º&nbsp;&nbsp;&nbsp;&nbsp; Copyright
        Â© 2024
        æ¡‚ICPå¤‡2024022150å·</a>
    </div>
  </div>
</template>


<script setup>
import {ref, reactive, computed, onMounted} from 'vue';
import request from "@/utils/request";
import {ElMessage, ElNotification} from 'element-plus';
// è·å–IP
const getUserIp = () => {
  fetch('https://api.ipify.org/?format=json')
      .then(response => response.json())
      .then(data => {
        localStorage.setItem("ip",data.ip)
      })
      .catch(error => {
        console.log(error);
      });
}
getUserIp()
const searchQuery = ref('');
const randomlySelectedItem = ref(null);

const targetDate = new Date('2041-06-07');
const diudiugaokao = ref(0);

const DaoJiShiDate = new Date('2024-09-17');
const DaoJiShi = ref(0);

const rules = ({
  table: [
    {required: true, message: 'è¯·é€‰æ‹©åˆ†æ ', trigger: 'blur'},
  ],
  barrage: [
    {required: true, message: 'è¯·è¾“å…¥å¼¹å¹•', trigger: 'blur'},
  ]
})

//æäº¤
const saveBarrage = () => {
  if (data.table === '' || data.barrage === '') {
    ElNotification.error("è¯·é€‰æ‹©åˆ†æ æˆ–è¾“å…¥å¼¹å¹•");
  } else {
    request.post('/addBarrage', {
      table: data.table,
      barrage: data.barrage
    }).then(res => {
      load()
      data.dialogFormVisible = false;
      if (res.code === '200') {
        ElNotification.success("æŠ•ç¨¿æˆåŠŸ");
      } else {
        ElNotification.error("è¯·æ±‚å¤±è´¥");
      }
    })
  }
}

const data = reactive({
  tableData: [],
  table: '',
  barrage: '',
})

const load = () => {
  request.get('/allBarrage/Page', {})
      .then(res => {
        // console.log(res);
        data.tableData = res.data || [];
        // console.log(data.tableData)
        getRandomItem();
      })
      .catch(err => {
        console.error('åŠ è½½æ•°æ®å¤±è´¥:', err);
      });
};

load();

//åœ¨æ•°ç»„ä¸­éšæœºå¼¹å¹•
const getRandomItem = () => {
  if (data.tableData.length > 0) {
    const randomIndex = Math.floor(Math.random() * data.tableData.length);
    randomlySelectedItem.value = data.tableData[randomIndex];
  }
};

// è¿‡æ»¤æœç´¢ç»“æœ
const filteredItems = computed(() => {
  return searchQuery.value
      ? data.tableData.filter(item =>
          item.barrage.toLowerCase().includes(searchQuery.value.toLowerCase())
      )
      : [];
});


const open2 = () => {
  ElMessage({
    message: 'å¤åˆ¶æˆåŠŸ',
    type: 'success',
  })
};

const open4 = () => {
  ElMessage.error('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦ç¦ç”¨navigator.clipboardå¯¹è±¡æˆ–æ‰‹åŠ¨å¤åˆ¶,è¯·å‹¿ä½¿ç”¨å¤¸å…‹æµè§ˆå™¨')
};

const copyText = (row) => {
  // console.log(row)
  navigator.clipboard.writeText(row.barrage)
      .then(() => {
        // å¤åˆ¶æˆåŠŸï¼Œå¯ä»¥æ˜¾ç¤ºæç¤ºä¿¡æ¯
        open2();
        console.log('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        request.post('/addCnt', {
          ip: localStorage.getItem('ip'),
          table: 'allbarrage',
          id: row.id
        })
      })
      .catch((err) => {
        // å¤åˆ¶å¤±è´¥ï¼Œå¯ä»¥æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        console.error('å¤åˆ¶å¤±è´¥:', err);
        open4()
      });
};


const calculateCountdown = () => {
  const now = new Date();
  const diffTime1 = targetDate - now;
  const diffTime2 = DaoJiShiDate - now;
  diudiugaokao.value = Math.ceil(diffTime1 / (1000 * 60 * 60 * 24));
  DaoJiShi.value = Math.ceil(diffTime2 / (1000 * 60 * 60 * 24));
};


// åœ¨ç»„ä»¶æŒ‚è½½æ—¶è®¡ç®—å€’è®¡æ—¶
onMounted(() => {
  calculateCountdown();
  // è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨æ¯å¤©æ›´æ–°ä¸€æ¬¡å€’è®¡æ—¶
  setInterval(calculateCountdown, 1000 * 60 * 60 * 24);
});

</script>


<style>
.DGjvpai {
  height: 80px;
  margin-bottom: -11px;
  display: flex;
  align-items: center;
}

.dog_head {
  margin-top: -10px;
  height: 70px;
  position: absolute;
}

.biabiabia {
  margin-top: -40px;
  height: 85px;
  position: absolute;
  margin-left: 10px;
}

.good {
  position: absolute;
  margin-top: -144px;
  height: 175px;
  margin-left: 300px;
}
</style>